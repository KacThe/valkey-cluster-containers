- name: Set prod_clusters
  set_fact:
    clusters:
      - "192.168.0.1:6390 192.168.0.1:6391 192.168.0.2:6390 192.168.0.2:6391 192.168.0.3:6390 192.168.0.3:6391 -a {{ valkey_password }}"
      - "192.168.0.1:6380 192.168.0.1:6381 192.168.0.2:6380 192.168.0.2:6381 192.168.0.3:6380 192.168.0.3:6381 -a {{ valkey_password }}"
      - "192.168.0.1:6370 192.168.0.1:6371 192.168.0.2:6370 192.168.0.2:6371 192.168.0.3:6370 192.168.0.3:6371 -a {{ valkey_password }}"
      - "192.168.0.1:6360 192.168.0.1:6361 192.168.0.2:6360 192.168.0.2:6361 192.168.0.3:6360 192.168.0.3:6361 -a {{ valkey_password }}"
      - "192.168.0.1:6350 192.168.0.1:6351 192.168.0.2:6350 192.168.0.2:6351 192.168.0.3:6350 192.168.0.3:6351 -a {{ valkey_password }}"
      - "192.168.0.1:6340 192.168.0.1:6341 192.168.0.2:6340 192.168.0.2:6341 192.168.0.3:6340 192.168.0.3:6341 -a {{ valkey_password }}"

- name: Run cluster creation for prod
  shell: "yes yes | valkey-cli --cluster create {{ item }} --cluster-replicas 1"
  loop: "{{ clusters }}"
  when: clusters | length > 0
  run_once: true
  no_log: true
